name: Validate Commit Messages

on: [push, pull_request]

jobs:
  check-commit-messages:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Validate commit messages
        run: |
          echo "Checking commit messages from ${{ github.event.before }} to ${{ github.sha }}"
          commits=$(git rev-list ${{ github.event.before }}..${{ github.sha }})
          for commit in $commits; do
            msg=$(git log -1 --pretty=format:%s $commit)
            echo "Commit: $commit"
            echo "Message: $msg"
            if ! echo "$msg" | grep -qE "#[0-9]+"; then
              echo "‚ùå Commit message does not contain an issue number like #123."
              exit 1
            fi
          done
